<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 * Read-me file for Version Information Component.
 *
 * $Rev$
 * $Date$
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<title>
	DelphiDabbler Version Information Component ReadMe
</title>

<style type="text/css">
	body {
    	margin: 1em;
		padding: 0;
		font-family: Verdana, Arial, sans-serif;
		font-size: 9pt;
		line-height: 150%;
	}
	h1 {
		margin: 0 0 1em 0;
		padding: 0.5em;
		border: 1px silver solid;
		background-color: #eee;
		font-size: 13pt;
		font-weight: bold;
		text-align: center;
	}
	h1 .subtitle {
		font-style: italic;
		color: #336;
	}
	h2 {
		margin: 1em 0 0 0;
		padding: 0;
		padding-bottom: 6px;
		border-bottom: 1px silver solid;
		font-size: 11pt;
		font-weight: bold;
	}
	h3 {
		margin: 0.5em 0 0 0;
		padding: 0;
		font-size: 9pt;
		font-weight: bold;
	}
	p {
		margin: 0.5em 0 0 0;
		padding: 0;
	}
	ul, ol {
		margin: 0.5em 0 0 3em;
		padding: 0;
	}
	ul {
		list-style-type: square;
	}
	ul.spaced li,
	ol.spaced li {
		margin-top: 0.5em;
	}
	ul.spaced li,
	ol.spaced li {
		margin-top: 0.5em;
	}
	ul.unspaced li,
	ol.unspaced li {
		margin-top: 0;
	}
	ul.unspaced li.first,
	ol.unspaced li.first {
		margin-top: 0.5em;
	}
	code {
		font-family: "Courier New", Courier, monospace;
	}
	a:link {
		color: #336;
		text-decoration: underline;
	}
	a:visited {
		color: #669;
		text-decoration: underline;
	}
	a:active {
		color: #336;
		text-decoration: underline;
	}
	a:hover {
		text-decoration: underline;
	}
	.gototop {
		margin: 1em 0 0 0;
		padding: 0.3em 0 0 0;
		text-align: center;
		position: relative;
		float: right;
		font-weight: bold;
	}
	.pullout {
		border-left: 8px silver solid;
		background-color: #eee;
		margin: 0.5em 0 0 0;
		padding: 0.25em 0.5em;
		font-style: italic;
	}
	.indent {
		margin-left: 3em;
	}
	.highlight {
		color: #336;
		font-style: italic;
		font-weight: bold;
	}
	.endnotes {
		margin: 1.5em 0 0 0;
		padding: 1em 0 0 0;
		border-top: 1px silver solid;
	}
	.comments {
		font-style: italic;
	}
	.copyright,
	.copyright a:link,
	.copyright a:visited,
	.copyright a:active {
		margin: 1em 0 0 0;
		color: gray;
		font-size: 8pt;
		text-align: right;
	}
	</style>

</head>

<body>

<h1>
	<div>Version Information Component</div>
	<div class="subtitle">ReadMe</div>
</h1>

<h2 id="contents">
	Contents
</h2>

<ul>
	<li><a href="#description">Description</a></li>
	<li><a href="#compatibility">Compatibility</a></li>
	<li><a href="#installation">Installation</a></li>
	<li><a href="#demo">Demo Projects</a></li>
	<li><a href="#update">Update History</a></li>
	<li><a href="#license">License and Disclaimer</a></li>
	<li><a href="#author">About the Author</a></li>
</ul>

<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="description">
	Description
</h2>

<p>
	<var>TPJVersionInfo</var> is a 32 bit non-visual component for all Win32
	versions of Delphi that encapsulates the version information contained in an
	executable file&#39;s resources.
</p>

<p>
	The component reads information from a designated file&#39;s
	<var>VERSIONINFO</var> resource. The required file is specified in the
	component&#39;s <var>FileName</var> property. Setting <var>FileName</var> to
	the empty string fetches version information for the executable file
	containing the component. The boolean <var>HaveInfo</var> property indicates
	whether the file contains version information. This component can access
	variable file information for each language provided in the resource.
</p>

<p>
	Run-time properties enable access to to version information. Properties
	enable:
</p>

<ul>
	<li>
		Access to fixed file information, either by field or the whole record.
	</li>
	<li>
		Access to the number of translations stored in the version information.
	</li>
	<li>
		Selection of the translation for which information is to be returned by
		other properties.
	</li>
	<li>
		Access to the language and code page of the current translation - by
		code and by name.
	</li>
	<li>
		Access to the string file information for the current translation -
		named properties access the Microsoft-defined string information, while
		an array property gives access to any string item by name.
	</li>
</ul>

<h3>
	Limitations
</h3>

<p>
	The component makes calls to the Windows API. Therefore the version
	information being read must follow the Microsoft guidelines - be warned that
	not all software complies!
</p>

<h3>
	Further information
</h3>

<p>
	For detailed information about version information refer to the Windows SDK.
</p>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="compatibility">
	Compatibility
</h2>

<h3>
	Delphi compatibility
</h3>

<p>
	<var>TPJVersionInfo</var> compiles on all Win32 versions and personalities
	of Delphi. It has been tested with Delphi versions 2, 3, 4, 6, 7, 2006 
	and 2010. It is assumed to work on other versions.
</p>

<h3>
	Compatibility with previous versions
</h3>

<p>
	The unit name changed to <code>PJVersionInfo</code> at release 3 - this
	means that programs using earlier versions will need to be modified (or to
	have an alias set in Delphi&#39;s Project Options) before being recompiled
	using the new version. Functionally, the component is backward compatible
	with earlier versions.
</p>

<h3>
	Help system compatibility
</h3>

<p>
	The help file is not compatible with the Delphi 2, and Delphi 2005 and late
	IDEs, although it can be used separately.
</p>

<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="installation">
	Installation
</h2>

<p>
	In these instructions <code><strong>$(DELPHI)</strong></code> is to be
	taken to represent the path where the appropriate version of Delphi was
	installed. Similarly <code><strong>$(BDS)</strong></code> refers to the
	installation path of a version of the Borland Developement System.
</p>

<p>
	Note that the help file included in the download can only integrate with the
	IDE in Delphi 3-7.
</p>

<div class="pullout">
	<strong>Important Note:</strong> If you are updating from an earlier version
	of this component and have installed the <em>DelphiDabbler</em> About Box
	Component (<var>TPJAboutBoxDlg</var>) you may need to uninstall it before
	updating this component, and re-install the about box component once the
	update has been installed. If the About Box Component is earlier that v3.2
	it will need to be updated to the most recent version.
</div>

<p>
	The installation method differs depending on the version of Delphi.
	Therefore the instructions are divided as follows:
</p>

<ul>
	<li><a href="#bds">Installation with Delphi 2005 &amp; Later</a></li>
	<li><a href="#d3">Installation with Delphi 3 to 7</a></li>
	<li><a href="#d2">Installation with Delphi 2</a></li>
</ul>

<h3 id="bds">
	Installation with Delphi 2005 &amp; Later
</h3>

<ol class="spaced">
	<li>
		Unzip the downloaded zip file into a folder, preserving the directory
		structure.
	</li>
	<li>
		Copy <code>PJVersionInfo.pas</code> and <code>PJVersionInfo.dcr</code>
		to where you wish to install into Delphi. This will probably be a
		sub-folder of <code>$(BDS)\lib</code>.
	</li>
	<li>
		To install the component it must be included in a design package. You
		can either create a new design package or add the component to an
		existing one. These instructions assume you will be installing into an
		existing package.
		<ul>
			<li>
				Open the required package. Select <em>File | Open</em> menu and
				choose a suitable package source file. You may decide to install
				into the &quot;user&quot; package. This is found in <code>
				$(BDS)\Lib</code> and is named <code>dclusr.dpk</code>. You can
				select this file or the associated <code>dclusr.bdsproj</code>
				file.
			</li>
			<li>
				The package (with <code>.bpl</code> extension) will now be
				displayed in the Project Manager. If the package has not been
				installed right click the <code>.bpl</code> entry in the Project
				Manager and select <em>Install</em>. Dismiss any resulting
				message dialog.
			</li>
			<li>
				Now right click the <code>.bpl</code> entry again and select
				<em>Add</em>. The &quot;Add&quot; dialog box will be displayed.
				Click the dialog&#39;s <em>Browse</em> button then select <code>
				PJVersionInfo.pas</code> from the resulting file open dialog.
				The full path to the file should now be displayed in the
				&quot;Add&quot; dialog&#39;s <em>Unit file name</em> edit box.
				Click <em>OK</em> to add the component to the package.
			</li>
			<li>
				Back in the Project Manager, check that
				<code>PJVersionInfo.pas</code> and
				<code>PJVersionInfo.dcr</code> appear under the package&#39;s
				&quot;Contains&quot; node. If so, right click the
				<code>.bpl</code> entry again and select <em>Compile</em>. The
				package will now be recompiled and, if all is well, a message
				should be displayed indicating that <var>TPJVersionInfo</var>
				has been registered. The component should now appear in the
				&quot;DelphiDabbler&quot; section of the Tool Palette. (Note
				this will only appear when a form is selected in the designer).
			</li>
			<li>
				Close the package project using the <em>File | Close</em> menu
				item. If a prompt appears offering to save the package project,
				accept this.
			</li>
		</ul>
	</li>
	<li>
		If you wish you can now delete <code>PJVersionInfo.pas</code> from the
		place where you copied it.
	</li>
	<li>
		The supplied demo programs can be loaded into the IDE and compiled and
		run as required.
	</li>
</ol>

<h3 id="d3">
	Installation with Delphi 3 to 7
</h3>

<ol class="spaced">
	<li>
		Unzip the downloaded zip file into a folder, preserving the directory
		structure.
	</li>
	<li>
		Copy <code>PJVersionInfo.pas</code> and <code>PJVersionInfo.dcr</code>
		to where you wish to install into Delphi. This will probably be a
		sub-folder of <code>$(DELPHI)\lib</code>.
	</li>
	<li>
		To install the component it must be included in a design package. You
		can either create a new design package or add the component to an
		existing one. These instructions assume you will be installing into an
		existing package.
		<ul>
			<li>
				Open the required package. Select <em>File | Open</em> menu,
				make sure that files with the <code>*.dpk</code> extenstion are
				being displayed, and choose a suitable package source file. You
				may decide to install into the &quot;user&quot; package. This is
				found in <code>$(DELPHI)\Lib</code> and is named
				<code>dclusr.dpk</code> or <code>dclusrXX.dpk</code> where
				<code>XX</code> is a version number.
			</li>
			<li>
				The package editor will now be displayed. If its
				<em>Install</em> button is not disabled then click it to ensure
				the package is installed into Delphi. Dismiss any resulting
				message dialog.
			</li>
			<li>
				Now click the package editor&#39;s <em>Add</em> button. The
				&quot;Add&quot; dialog box will be displayed. Click the
				dialog&#39;s <em>Browse</em> button then select
				<code>PJVersionInfo.pas</code> from the resulting file open
				dialog. The full path to the file should now be displayed in the
				&quot;Add&quot; dialog&#39;s <em>Unit file name</em> edit box.
				Click <em>OK</em> to add the component to the package.
			</li>
			<li>
				Click the package editor&#39;s <em>Compile</em> button. The
				package will now be recompiled and, if all is well, a message
				should be displayed indicating that <var>TPJVersionInfo</var>
				has been registered. The component should now appear in the
				Component Palette on the &quot;DelphiDabbler&quot; tab.
			</li>
			<li>
				Now close the package editor window. You will probably be
				prompted to save the package. Agree to this and the package
				source file will be updated with information about the new
				component.
			</li>
		</ul>
	</li>
	<li>
		If you wish you can now delete <code>PJVersionInfo.pas</code> from the
		place where you copied it.
	</li>
	<li>
		The simplest way to install the help file is to use my
		<a href="http://www.delphidabbler.com/software?id=chi">Component Help
		Installer Expert</a>. The download includes an <code>.als</code> a-link
		keyword file for use with Delphi 6 and 7.
		<em>Component Help Installer</em> v2.2 or later can also install the
		keyword file for you. If you prefer to install manually,
		<a href="http://www.delphidabbler.com/articles?article=15">this
		article</a> explains the process.
	</li>
	<li>
		The supplied demo programs can be loaded into Delphi and compiled and
		run as required. <span class="highlight">Please note:</span> the demo
		programs do not compile and run correctly under Delphi 3.
	</li>
</ol>

<h3 id="d2">
	Installation with Delphi 2
</h3>

<ol class="spaced">
	<li>
		Unzip the downloaded zip file into a folder, preserving the directory
		structure.
	</li>
	<li>
		Copy <code>PJVersionInfo.pas</code> and <code>PJVersionInfo.dcr</code>
		to where you wish to install into Delphi. This will probably be a
		sub-folder of <code>$(DELPHI)\lib</code>.
	</li>
	<li>
		Install into Delphi as follows:
		<ul>
			<li>
				Select the <em>Component | Install</em> menu option to display
				the &quot;Install Components&quot; dialog box.
			</li>
			<li>
				Click the <em>Add</em> button to display the &quot;Add
				Module&quot; dialog box.
			</li>
			<li>
				Click the <em>Browse</em> button and choose
				<code>PJVersionInfo.pas</code> from the resulting standard file
				open dialog box and click <em>Open</em>.
			</li>
			<li>
				This returns you to the &quot;Install Components&quot; dialog
				box. Click <em>OK</em> here to rebuild the component
				library.
			</li>
			<li>
				<var>TPJVersionInfo</var> should now appear on the
				&quot;DelphiDabbler&quot; tab of the component palette.
			</li>
		</ul>
	</li>
	<li>
		If you wish you can now delete <code>PJVersionInfo.pas</code> from the
		place where you copied it.
	</li>
	<li>
		<span class="highlight">Please note:</span> the demo programs do not
		compile and run correctly under Delphi 2.
	</li>
</ol>

<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="demo">
	Demo Projects
</h2>

<p>
	The source code for two demo projects is included. The demos are:
</p>

<ol class="spaced">
	<li>
		<code>VIDemo.dpr</code> is an application that can extract and display
		version information from any program (provided that the program has
		valid version information).
	</li>
	<li>
		<code>HelpEgs.dpr</code> implements all the examples from the component
		help file.
	</li>
</ol>

<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="update">
	Update History
</h2>

<p>
	A complete change log is provided in a text file that is included in the
	download.
</p>
  
<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="license">
	License and Disclaimer
</h2>

<p>
	This source code is subject to the Mozilla Public License Version 1.1 (the
	&quot;License&quot;); you may not use this code except in compliance with
	the License. You may obtain a copy of the License at
	<a
		href="http://www.mozilla.org/MPL/MPL-1.1"
	>http://www.mozilla.org/MPL/MPL-1.1</a>.
</p>

<p>
	Software distributed under the License is distributed on an &quot;AS
	IS&quot; basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See
	the License for the specific language governing rights and limitations under
	the License.
</p>

<p>
	The Original Code is Version Information Component.
</p>

<p>
	The Initial Developer of the Original Code is Peter Johnson
	(http://www.delphidabbler.com/).
</p>

<p>
	Portions created by the Initial Developer are Copyright &copy; 1998-2005
	Peter Johnson. All Rights Reserved.
</p>

<p>
	Contributor(s):
</p>

<p class="indent">
	Roland Beduerftig (C++ builder compatibility)
</p>

<p>
	All relevant trademarks are acknowledged.
</p>

<p class="pullout">
	A copy of the license is included in the download &ndash see
	<code>MPL.txt</code>.
</p>


<p class="gototop">
	&raquo; <a href="#contents">Contents</a>
</p>

<h2 id="author">
	About the Author
</h2>

<p>
	I'm Peter Johnson &ndash; a hobbyist programmer living in Ceredigion in West
	Wales,  UK, writing write mainly in Delphi. My programs and code are
	available from:
	<a href="http://www.delphidabbler.com/">http://www.delphidabbler.com/</a>.
</p>

<p>
	I can be <a href="http://www.delphidabbler.com/contact">contacted via the
	website.</a>
</p> 


<div class="endnotes">

	<div class="comments">
		Please
		<a href="http://www.delphidabbler.com/contact">
		let me know</a> if you have any comments about the components, if you
		have found a bug, or you want to suggest any updates.
	</div>

	<div class="copyright">
		This document is copyright &copy; 2005-2009, P D Johnson,
		<a href="http://www.delphidabbler.com/">
		www.delphidabbler.com</a>
	</div>

</div>

</body>

</html>